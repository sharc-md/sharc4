\documentclass[10pt]{article}

\usepackage{tikz,graphicx,pgfplots,amsmath}
% \usepackage[lighttt]{lmodern}
\usepackage{libertine}
\usepackage[libertine]{newtxmath}
\usepackage[scaled=0.95]{inconsolata}
\usepackage{mycolors}
\usepackage{sfmath}
\usepackage[version=3]{mhchem}
\usepackage[active,tightpage]{preview}


\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{1pt}
\setlength{\textwidth}{246pt}


\pgfplotsset{every tick label/.append style={/pgf/number format/1000 sep={}}}
% \pgfplotsset{compat=1.3}
\usetikzlibrary{plotmarks,fit,positioning,arrows}
\usetikzlibrary{calc}
\usetikzlibrary{trees}


\newcommand*\phantomas[3][c]{% 
   \ifmmode 
     \makebox[\widthof{$#2$}][#1]{$#3$}% 
   \else 
     \makebox[\widthof{#2}][#1]{#3}% 
   \fi 
} 


\begin{document}[font=\sffamily]
% \begin{figure}[h]
  % Define block styles
  \tikzstyle{input} = [rectangle, draw, fill=black!20, 
      text width=7em, text centered, rounded corners, minimum height=4em]
  \tikzstyle{interm} = [rectangle, draw, fill=B!20,
      text width=8em, text centered, rounded corners, minimum height=4em]
  \tikzstyle{cloud} = [draw,,fill=R!30,
      minimum height=2em, text width=6em, text centered]
  \tikzstyle{op} = [draw, fill=Y!20]    
  \tikzstyle{line} = [draw, -stealth,thick]   

  \centering
  \begin{tikzpicture}[node distance = 9em, auto]
      % Place nodes for Overlap Flowchart
      \node [cloud] (SIJ) {$\left<\Psi_I\mid\Psi_J'\right>$};
      \node [op, above of=SIJ, node distance=4em] (cont) {Contract};
          \node [interm, left of=cont] (bovl) {Unique factors

          $\mathcal{S}_{kl}, \bar{\mathcal{S}}_{kl}$};
          \node [op, above of=bovl, node distance=4em] (prec) {Precompute};
          \node [op, above of=prec, node distance=3em] (sort) {Sort};
          \node [input, above of=sort, node distance=4em] (det) {Slater \\Determinants

          $\left|\Phi_k\right>, \left|\Phi_l'\right>$};    
      \node [input, right of=det] (cic) {CI coefficients

      $d_{kI},d_{lJ}'$};
          \node [interm, left of=prec, node distance=13.5em] (Smo) {MO overlaps

          $\left<\varphi_p|\varphi_q'\right>$};
          \node [input, left of=det] (C) {MO coefficients

          $C_{p\mu}, C_{q\nu}'$};
          \node [input, left of=C] (Sao) {\textit{Double molecule}

          AO overlaps

          $\left<\chi_{\mu}|\chi_{\nu}'\right>$};
      % Edges
      \path [line] (cont) -- (SIJ);
      \path [line] (cic) -- (cont);
      \path [line] (bovl) -- (cont);
      \path [line] (det) -- (sort);
      \path [line] (sort) -- (prec);
      \path [line] (prec) -- (bovl);
      \path [line] (Smo) -- (prec);
      \path [line] (C) -| (Smo);
      \path [line] (Sao) -| (Smo);
  \end{tikzpicture}
%   \caption{Workflow of the wavefunction overlap program.}
%   \label{fig:work}
% \end{figure}
\end{document}